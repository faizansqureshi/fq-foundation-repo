{
    "Version": "2012-10-17",
    "Statement": [
        {
          "Sid": "DenyS3BucketsPublicAccess",
          "Effect": "Deny",
          "Action": [
            "s3:PutBucketPublicAccessBlock",
            "s3:PutAccountPublicAccessBlock",
            "s3:PutAccessPointPublicAccessBlock"
          ],
          "Resource": "*"
        },
        {
          "Sid": "DenyS3IfNotInEncryptionInTransit",
          "Effect": "Deny",
          "Action": [
            "s3:*"
          ],
          "Resource": [               
            "arn:aws:s3:::/*",
            "arn:aws:s3:::"
          ],
          "Condition": {
            "Bool": {
              "aws:SecureTransport": "false"
            }
          }
        },
        {
          "Sid": "DenyLambdaWithoutVpc",
          "Effect": "Deny",
          "Action": [
            "lambda:CreateFunction",
            "lambda:UpdateFunctionConfiguration"
          ],
          "Condition": {
            "Null": {
              "lambda:VpcIds": "true"
            }
          },
          "Resource": "*"
        },
        {
          "Sid": "DenyEC2AssociatePublicIp",
          "Effect": "Deny",
          "Action": "ec2:RunInstances",
          "Condition": {
            "Bool": {
              "ec2:AssociatePublicIpAddress": "true"
            }
          },
          "Resource": "*"
        },
        {
          "Sid": "RequireAllEc2RolesToUseV2",
          "Effect": "Deny",
          "Action": "*",
          "Resource": "*",
          "Condition": {
              "NumericLessThan": {
                  "ec2:RoleDelivery": "2.0"
              }
          }
        },
        {
          "Sid": "DenyInternetFacingElasticLoadbalancer",
          "Effect": "Deny",
          "Action": [
            "elasticloadbalancing:CreateLoadBalancer"
          ],
          "Resource": "*",
          "Condition": {
            "StringEquals": {
              "elasticloadbalancing:Scheme": "internet-facing"
            }
          }
        }
    ]
}